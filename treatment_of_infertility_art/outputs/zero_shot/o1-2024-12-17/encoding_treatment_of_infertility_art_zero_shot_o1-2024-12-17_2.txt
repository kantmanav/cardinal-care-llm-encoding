covered(C) :-
    % Must be an ART service for fertility preservation
    claim_service_type(C, ServiceType),
    ( ServiceType = ivf_for_fertility_preservation
    ; ServiceType = cryopreservation_for_fertility_preservation ),

    % Must be in-network
    claim_location_service_received(C, Location),
    Location \= other,

    % Patient must be believed to be fertile
    claim_patient_is_believed_to_be_fertile(C, yes),

    % Must have a planned service that results in infertility
    claim_planned_service(C, PlannedService),
    ( PlannedService = chemotherapy
    ; PlannedService = pelvic_radiotherapy
    ; PlannedService = gonadotoxic_therapy
    ; PlannedService = orchiectomy
    ; PlannedService = oophorectomy
    ; PlannedService = hysterectomy
    ; PlannedService = orchiectomy_for_treatment_of_disease
    ; PlannedService = oophorectomy_for_treatment_of_disease
    ; PlannedService = other_treatment_demonstrated_to_result_in_infertility
    ),

    % If eggs are being retrieved for use, check FSH criteria
    ( claim_will_be_retrieving_eggs_for_use(C, yes)
      -> check_fsh_criteria(C)
    ; true
    ).

check_fsh_criteria(C) :-
    patient_age_at_time_of_service(C, Age),
    (  Age < 39 ->
       most_recent_day_3_fsh_test(C, fsh_test(Level, _, _)),
       Level < 19

    ;  Age =:= 39 ->
       claim_date_service_received(C, SvcDate),
       most_recent_day_3_fsh_test(C, fsh_test(Level, TestDate, _)),
       leq_n_months_diff(TestDate, SvcDate, 6),
       Level < 19

    ;  Age >= 40 ->
       claim_date_service_received(C, SvcDate),
       most_recent_day_3_fsh_test(C, fsh_test(Level, TestDate, _)),
       leq_n_months_diff(TestDate, SvcDate, 6),
       claim_patient_has_premature_ovarian_failure(C, POF),
       (  POF = yes ->
          Level < 19
       ;  POF = no ->
          day_3_fsh_tests_since_age_40_in_claim(C, Tests),
          \+ exists_test_with_level_at_least_19(Tests)
       )
    ).

