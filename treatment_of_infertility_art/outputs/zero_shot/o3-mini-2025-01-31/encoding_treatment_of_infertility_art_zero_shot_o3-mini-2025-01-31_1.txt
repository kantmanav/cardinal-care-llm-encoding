covered(C) :-
    claim_service_type(C, ServiceType),
    ( ServiceType = ivf_for_fertility_preservation ; ServiceType = cryopreservation_for_fertility_preservation ),
    claim_location_service_received(C, Location),
    Location \= other,
    claim_patient_is_believed_to_be_fertile(C, yes),
    claim_planned_service(C, Planned),
    ( Planned = chemotherapy ;
      Planned = pelvic_radiotherapy ;
      Planned = gonadotoxic_therapy ;
      Planned = orchiectomy ;
      Planned = oophorectomy ;
      Planned = hysterectomy ;
      Planned = orchiectomy_for_treatment_of_disease ;
      Planned = oophorectomy_for_treatment_of_disease ;
      Planned = other_treatment_demonstrated_to_result_in_infertility ;
      Planned = other ),
    ( claim_will_be_retrieving_eggs_for_use(C, yes) ->
         ( patient_age_at_time_of_service(C, Age),
           claim_date_service_received(C, ServiceDate),
           most_recent_day_3_fsh_test(C, fsh_test(Level, TestDate, _)),
           ( Age >= 39 -> leq_n_months_diff(TestDate, ServiceDate, 6) ; true ),
           ( Age < 40 -> Level < 19
           ; Age >= 40 ->
                 ( claim_patient_has_premature_ovarian_failure(C, yes) ->
                       Level < 19
                 ; day_3_fsh_tests_since_age_40(C, Tests),
                   \+ exists_test_with_level_at_least_19(Tests)
                 )
           )
         )
    ; true ).