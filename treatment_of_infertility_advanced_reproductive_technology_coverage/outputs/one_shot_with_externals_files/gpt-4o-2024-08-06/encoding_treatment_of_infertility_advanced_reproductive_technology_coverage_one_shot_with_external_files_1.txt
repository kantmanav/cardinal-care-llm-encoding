```prolog
covered(C) :-
    claim.service_type(C, ivf_for_fertility_preservation) &
    service_received_at_valid_provider(C) &

    (
        (
            claim.patient_is_believed_to_be_fertile(C, yes) &
            claim.will_be_retrieving_eggs_for_use(C, yes) &
            claim.planned_service(C, PlannedService) & 
            member(PlannedService, [
                chemotherapy,
                pelvic_radiotherapy,
                gonadotoxic_therapy,
                orchiectomy,
                oophorectomy,
                hysterectomy,
                orchiectomy_for_treatment_of_disease,
                oophorectomy_for_treatment_of_disease,
                other_treatment_demonstrated_to_result_in_infertility
            ])
        ) 
    ) &

    (
        (
            patient_age_at_time_of_service(C, Age) &
            claim.patient_has_premature_ovarian_failure(C, yes) &
            less(Age, 45)
        ) ;

        (
            patient_age_at_time_of_service(C, Age) &
            less(Age, 39) &
            most_recent_day_3_fsh_test(C, fsh_test(Level, _, _)) &
            less(Level, 19)
        ) ;

        (
            patient_age_at_time_of_service(C, Age) &
            leq(39, Age) &
            day_3_fsh_tests_since_age_40_in_claim(C, Tests) &
            ~exists_test_with_level_at_least_19(Tests)
        )
    ) &

    (
        claim.inseminations_not_expected_to_be_effective_and_ivf_expected_to_be_only_effective_treatment(C, yes) ;
        claim.num_cycles_oral_or_injectable_ovulation_induction(C, NumCycles) &
        (
            (
                patient_age_at_time_of_service(C, Age) &
                less(Age, 38) &
                leq(3, NumCycles)
            ) ;

            (
                patient_age_at_time_of_service(C, Age) &
                leq(38, Age)
            )
        )
    ) &

    claim.num_other_covered_art_services(C, NumOtherArts) &
    less(NumOtherArts, 1).

covered(C) :-
    claim.service_type(C, cryopreservation_for_fertility_preservation) &
    service_received_at_valid_provider(C) &

    claim.patient_is_believed_to_be_fertile(C, yes) &
    claim.planned_service(C, PlannedService) & 
    member(PlannedService, [
        chemotherapy,
        pelvic_radiotherapy,
        gonadotoxic_therapy,
        orchiectomy,
        oophorectomy,
        hysterectomy,
        orchiectomy_for_treatment_of_disease,
        oophorectomy_for_treatment_of_disease,
        other_treatment_demonstrated_to_result_in_infertility
    ]).
```

