covered(C) :-
    claim_service_type(C, ServiceType),
    member(ServiceType, [ivf_for_fertility_preservation, cryopreservation_for_fertility_preservation]),
    claim_location_service_received(C, Location),
    Location \= other,
    claim_patient_is_believed_to_be_fertile(C, yes),
    claim_planned_service(C, PlannedService),
    member(PlannedService, [chemotherapy, pelvic_radiotherapy, gonadotoxic_therapy, orchiectomy, oophorectomy, hysterectomy, orchiectomy_for_treatment_of_disease, oophorectomy_for_treatment_of_disease, other_treatment_demonstrated_to_result_in_infertility, other]),
    claim_inseminations_not_expected_to_be_effective_and_ivf_expected_to_be_only_effective_treatment(C, _),
    claim_num_cycles_oral_or_injectable_ovulation_induction(C, _),
    claim_num_other_covered_art_services(C, OtherCycles),
    OtherCycles < 1,
    claim_will_be_retrieving_eggs_for_use(C, EggsRetrieve),
    ( EggsRetrieve = no
    -> true
    ;  patient_age_at_time_of_service(C, Age),
       claim_date_service_received(C, ServiceDate),
       ( Age < 40
       -> most_recent_day_3_fsh_test(C, fsh_test(Level, TestDate, _)),
          Level < 19,
          ( Age >= 39 -> leq_n_months_diff(TestDate, ServiceDate, 6) ; true )
       ;  ( claim_patient_has_premature_ovarian_failure(C, yes)
          -> Age < 45,
             most_recent_day_3_fsh_test(C, fsh_test(Level, TestDate, _)),
             Level < 19,
             leq_n_months_diff(TestDate, ServiceDate, 6)
          ;  day_3_fsh_tests_since_age_40_in_claim(C, Tests),
             \+ exists_test_with_level_at_least_19(Tests)
          )
       )
    ).

