is_eligible_art_service(ivf_for_fertility_preservation).
is_eligible_art_service(cryopreservation_for_fertility_preservation).

is_in_network_location(stanford_health_care).
is_in_network_location(menlo_medical_clinic).
is_in_network_location(sutter_health_palo_alto_medical_foundation).
is_in_network_location(tier_two_in_network).

is_planned_service_that_results_in_infertility(chemotherapy).
is_planned_service_that_results_in_infertility(pelvic_radiotherapy).
is_planned_service_that_results_in_infertility(gonadotoxic_therapy).
is_planned_service_that_results_in_infertility(orchiectomy).
is_planned_service_that_results_in_infertility(oophorectomy).
is_planned_service_that_results_in_infertility(hysterectomy).
is_planned_service_that_results_in_infertility(orchiectomy_for_treatment_of_disease).
is_planned_service_that_results_in_infertility(oophorectomy_for_treatment_of_disease).
is_planned_service_that_results_in_infertility(other_treatment_demonstrated_to_result_in_infertility).

covered(C) :-
    claim.service_type(C, S),
    is_eligible_art_service(S),
    claim.location_service_received(C, L),
    is_in_network_location(L),
    claim.patient_is_believed_to_be_fertile(C, yes),
    claim.planned_service(C, PS),
    is_planned_service_that_results_in_infertility(PS),
    claim.will_be_retrieving_eggs_for_use(C, yes),
    claim.patient_has_premature_ovarian_failure(C, no),
    claim.num_other_covered_art_services(C, N),
    N < 1.

