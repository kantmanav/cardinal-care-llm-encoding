covered(C) :-
  coverage_for_fertility_preservation(C);
  coverage_for_premature_ovarian_failure(C).

coverage_for_fertility_preservation(C) :-
  % Must be an ART service for fertility preservation
  claim.service_type(C, Service),
  (Service = ivf_for_fertility_preservation; Service = cryopreservation_for_fertility_preservation),

  % ART is not covered out-of-network
  claim.location_service_received(C, Location),
  Location \= other,

  % Must not exceed maximum number of covered ART services this policy year
  claim.num_other_covered_art_services(C, NumUsed),
  NumUsed < 1,

  % Must be believed to be fertile and have a qualifying planned service
  claim.patient_is_believed_to_be_fertile(C, yes),
  ( claim.planned_service(C, chemotherapy)
  ; claim.planned_service(C, pelvic_radiotherapy)
  ; claim.planned_service(C, gonadotoxic_therapy)
  ; claim.planned_service(C, orchiectomy)
  ; claim.planned_service(C, oophorectomy)
  ; claim.planned_service(C, hysterectomy)
  ; claim.planned_service(C, other_treatment_demonstrated_to_result_in_infertility)
  ),

  % Eggs that will be retrieved must be expected to result in successful pregnancy
  % (no POF) and retrieval must be occurring
  not claim.patient_has_premature_ovarian_failure(C, yes),
  claim.will_be_retrieving_eggs_for_use(C, yes).

coverage_for_premature_ovarian_failure(C) :-
  % IVF is covered under certain conditions for POF
  claim.service_type(C, ivf_for_fertility_preservation),

  % ART is not covered out-of-network
  claim.location_service_received(C, Location),
  Location \= other,

  % Must not exceed maximum number of covered ART services this policy year
  claim.num_other_covered_art_services(C, NumUsed),
  NumUsed < 1,

  % Patient has premature ovarian failure
  claim.patient_has_premature_ovarian_failure(C, yes).

