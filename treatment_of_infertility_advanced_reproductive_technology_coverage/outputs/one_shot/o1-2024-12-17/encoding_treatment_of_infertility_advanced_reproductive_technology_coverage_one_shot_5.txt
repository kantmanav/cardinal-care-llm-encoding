covered(C) :-
    % 1) Must be an ART service for fertility preservation
    ( claim.service_type(C, ivf_for_fertility_preservation)
    ; claim.service_type(C, cryopreservation_for_fertility_preservation)
    ),

    % 2) ART services are not covered out-of-network
    claim.location_service_received(C, L),
    ( L = stanford_health_care
    ; L = menlo_medical_clinic
    ; L = sutter_health_palo_alto_medical_foundation
    ; L = tier_two_in_network
    ),

    % 3) Must not exceed the maximum number of covered ART cycles per policy year
    %    (Aetna Student Health Plan: 1 course of treatment per policy year)
    claim.num_other_covered_art_services(C, N),
    N < 1,

    % 4) For fertility preservation, must be believed to be fertile and
    %    must be undergoing a planned service that will result in infertility
    claim.patient_is_believed_to_be_fertile(C, yes),
    claim.planned_service(C, PS),
    ( PS = chemotherapy
    ; PS = pelvic_radiotherapy
    ; PS = gonadotoxic_therapy
    ; PS = orchiectomy
    ; PS = oophorectomy
    ; PS = hysterectomy
    ; PS = orchiectomy_for_treatment_of_disease
    ; PS = oophorectomy_for_treatment_of_disease
    ; PS = other_treatment_demonstrated_to_result_in_infertility
    ),

    % 5) If eggs will be retrieved, must meet the FSH/ovarian reserve criteria
    %    from Aetna’s Infertility Clinical Policy OR have premature ovarian failure coverage
    (
      claim.will_be_retrieving_eggs_for_use(C, no)
    ;
      (
        claim.will_be_retrieving_eggs_for_use(C, yes),
        (
          % Women with premature ovarian failure may qualify under POF benefits
          claim.patient_has_premature_ovarian_failure(C, yes)

          % Otherwise must satisfy day 3 FSH < 19 mIU/mL (if < 40),
          % or unmedicated day 3 FSH < 19 mIU/mL in all prior tests (if >= 40),
          % and must not be in natural menopause after age 40
          ; /* Replace the line below with appropriate fact checks if day-3-FSH and age
               are represented; here we merely acknowledge the requirement. */
            /* meets_ovarian_reserve_criteria(C) */
            true
        )
      )
    ),

    % 6) Must not be excluded by any provision in the Aetna Infertility Clinical Policy
    %    (e.g., coverage limitations for women ≥ 40 with natural menopause, or plan exclusions)
    %    and must overall comply with plan design regarding ART eligibility.
    %    Here we assume that all such exclusions would appear as a separate condition,
    %    or that failing them would fail this rule. If needed, add explicit checks:
    % not(exclusion_applies(C)),
    true.

